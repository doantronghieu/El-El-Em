# Default values for mychart.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  fastapi:
    repository: doantronghieu/llm-fastapi
    tag: latest
    pullPolicy: Always # IfNotPresent, Always
  streamlit:
    repository: doantronghieu/llm-streamlit
    tag: latest
    pullPolicy: Always

resources:
  fastapi:
    limits:
      cpu: "3000m" # 1000m = 1cpu
      memory: "8Gi"
    requests:
      cpu: "1000m"
      memory: "1Gi" # Mi, Gi
  streamlit:
    limits:
      cpu: "1000m"
      memory: "8Gi"
    requests:
      cpu: "1000m"
      memory: "1Gi"

services:
  fastapi:
    name: fastapi
    type: ClusterIP
    port: 80
    targetPort: 8000
  streamlit:
    name: streamlit
    type: LoadBalancer
    port: 80
    targetPort: 8051
    externalTrafficPolicy: Cluster

ingress:
  name: my-ingress
  enabled: true
  annotations:
    rewriteTarget: /${2}
    useRegex: "true"
    proxyBodySize: "50m"
    sslRedirect: "true"
    certManagerIssuer: "letsencrypt-prod"
  hosts: my-domain.com
  tls:
    secretName: my-domain-tls
  ingressClassName: nginx

hpa:
  minReplicas: 1
  maxReplicas: 10
  cpuUtilization: 80
  memoryUtilization: 80
